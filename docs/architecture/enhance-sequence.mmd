%%{init: {'theme':'dark', 'sequence': { 'actorFontSize': '22px', 'messageFontSize': '20px' }}}%%
sequenceDiagram
    %% /enhance Command Sequence
    
    participant U as 👤 User
    participant CC as 📝 Claude Code
    participant EC as 📄 ~/.claude/commands/enhance.md
    participant C as 🤖 Claude
    participant MD as 📋 CLAUDE.md
    
    U->>CC: /enhance fix broken tests
    CC->>EC: Load command definition
    EC->>C: Execute with $ARGUMENTS
    C->>C: Detect context: "testing"
    C->>MD: Read project rules
    MD->>C: Return relevant rules
    C->>C: Select: "NEVER claim success if tests failing"
    C->>U: Enhanced prompt with context-aware rules